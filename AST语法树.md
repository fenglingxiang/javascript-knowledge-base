## AST 语法树

AST 语法树是一种用于表示源代码结构的树形结构，是由一个个节点组成的，每个节点代表了一种特定的语法结构或语法定义，常用于解析、转换和生成代码

1. 解析验证：通过解析源码转换成 AST 树状结构后，可以对代码进行静态分析和验证，比如检查代码的语法错误、类型错误、变量引用等等，帮助发现潜在问题
2. 优化转换：AST 可用于执行各种优化操作，比如消除冗余代码、提取共享表达式、内联函数调用等。还可以进行代码转换，常见的就是可以将 es6 的代码转换成浏览器兼容的 es5 代码、将模板编译转换成渲染函数
3. 生成代码：AST 还可以再次生成目标代码，比如 js、css、html 等，这使得可以将源码翻译为其他语言、或是在不同平台执行代码等

通过 AST 语法树，使得开发人员能更好的理解和分析源码结构，并进行静态解析、优化和转换代码，它为编译器、静态代码分析工具等一众编程工具提供了基础。

## AST 语法树例子

```js
let total = 1 + 2;
```

```text
VariableDeclaration (kind: 'let')
|
└─── VariableDeclarator
     |
     ├─── Identifier (name: 'total')
     └─── AssignmentExpression (=)
          |
          └─── BinaryExpression (+)
               |
               ├─── NumericLiteral (value: 1)
               └─── NumericLiteral (value: 2)
```

### 关键点

1. 去除了不必要的细节：比如分号 ;、括号（在某些情况下）、空格等。这就是“抽象”的含义——它不关心具体的字符，只关心结构。
2. 体现了操作优先级：加法 1 + 2 作为一个独立的子树 (BinaryExpression)，它先被计算，然后结果再被赋值给 total。这完美地体现了 + 比 = 有更高的优先级。
3. 层次化结构：树形结构清晰地表示了代码的嵌套关系，1 + 2 是赋值表达式的一部分，而赋值表达式又是变量声明的一部分。

## 与 CST（具体语法树） 的区别

- CST（具体语法树）： 会包含词法分析产生的每一个细节，包括分号、空格、注释等每一个令牌。它非常庞大和复杂。
- AST（抽象语法树）： 是 CST 的简化版，只保留了对后续操作（如语义分析、优化）有意义的语法结构。现代编译器/工具几乎都使用 AST，因为它更简洁、更实用。

## AST 的实际应用

1. Babel：JavaScript 编译器

- 将 es6 及之后版本的代码转换成 es5 兼容的代码 (过程：ES6+ 代码 -> AST -> (插件对 AST 进行修改) -> ES5 代码)
- 将 jsx 或一些新的语法糖转换成普通的 js

2. ESLint / Prettier： 代码检查和格式化工具。

- 根据规则分析源码生成 AST 语法树，进行代码检查，提示错误或修正代码，最后输出格式化后的代码 (过程：代码 -> AST -> (根据规则分析 AST) -> 提示错误或直接修改 AST -> 输出格式化后的代码)

3. TypeScript Compiler：通过 AST 来进行类型检查。

4. 代码压缩工具（如 UglifyJS）：分析 AST，安全地重命名变量、删除死代码。
